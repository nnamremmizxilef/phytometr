% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_host_genotypes.R
\name{simulate_host_genotypes}
\alias{simulate_host_genotypes}
\title{Simulate host genotypes from a host model}
\usage{
simulate_host_genotypes(
  host_model,
  n_individuals,
  n_loci,
  maf_threshold = NULL,
  seed = NULL
)
}
\arguments{
\item{host_model}{Object of class \code{"host_model"} created by
\code{define_host_model()}.}

\item{n_individuals}{Integer. Number of host individuals (diploid)
to simulate.}

\item{n_loci}{Integer. Number of independent SNP loci to simulate.}

\item{maf_threshold}{Optional numeric in \link{0, 0.5}. If provided,
SNPs with minor allele frequency below this threshold are
filtered out.}

\item{seed}{Optional integer. If provided, used to set the random
seed for reproducibility.}
}
\value{
A list with elements:
\itemize{
\item \code{genotypes}: numeric matrix of dimension
\code{n_individuals x n_loci_filtered} with entries 0, 1, 2
corresponding to minor-allele counts per individual.
\item \code{host_model}: the input \code{host_model} (attached
for convenience).
}
}
\description{
Given a \code{host_model} object (created with
\code{define_host_model()}), this function simulates host SNP
genotypes for a specified number of individuals and loci.
}
\details{
For \code{type = "clone"}, all individuals are treated as having
effectively the same genotype (no true host variance). A trivial
genotype matrix is returned for compatibility.

For \code{type = "natural"}, the \pkg{coala} package is used to
simulate SNPs under a coalescent model. At the moment, only a
panmictic population is implemented; more complex structures can
be added later.

For natural populations, this function currently implements a
simple panmictic coalescent model using \pkg{coala}. This is
intentionally conservative: instead of guessing complex migration
matrices, we start with a clean panmictic baseline that can be
refined as the project evolves.

Technical note: the coalescent model is specified with
\code{ploidy = 2} so that the resulting segregating sites can
be interpreted as diploid genotypes (0/1/2). This assumes the
usual biallelic SNP setup.
}
\examples{
\dontrun{
library(coala)

# Simple panmictic host
host_nat <- define_host_model(
  type              = "natural",
  pop_structure     = "panmictic",
  Ne                = 1e5,
  mutation_rate     = 1,
  recombination_rate = 0
)

host_geno <- simulate_host_genotypes(
  host_model    = host_nat,
  n_individuals = 50,
  n_loci        = 500,
  maf_threshold = 0.05,
  seed          = 123
)

dim(host_geno$genotypes)  # 50 x (<= 500) after MAF filtering
}

}
