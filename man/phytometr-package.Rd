% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phytometer_package.R
\docType{package}
\name{phytometr-package}
\alias{phytometr-package}
\alias{phytometr}
\title{phytometr: Power Analysis for Genotype-Environment Association Studies in Holobiont Systems}
\description{
A comprehensive framework for experimental design and power analysis in
genotype-environment association (GEA) studies, with specialized support
for holobiont systems (host-microbiome interactions). The package simulates
realistic population genetic data using coalescent theory, environmental
gradients, and holobiont responses to determine required sample sizes for
detecting genotype-environment associations.
}
\section{Main functions}{


\strong{Data Structure:}
\itemize{
\item \code{\link{create_holobiont_data}} - Create integrated holobiont data structure
\item \code{\link{get_host_genotypes}}, \code{\link{get_environment}}, \code{\link{get_microbiome}} - Data accessors
\item \code{\link{set_host_genotypes}}, \code{\link{set_environment}} - Data setters
}

\strong{Power Analysis:}
\itemize{
\item \code{\link{simulate_gea_power}} - Simulate power for GEA studies
\item \code{\link{calculate_required_n}} - Calculate required sample size for target power
\item \code{\link{compare_power_scenarios}} - Compare power across study designs
}

\strong{Diagnostics:}
\itemize{
\item \code{\link{diagnose_holobiont_data}} - Comprehensive data quality assessment
\item \code{\link{assess_gea_assumptions}} - Check GEA analysis assumptions
}

\strong{Visualization:}
\itemize{
\item \code{plot()} methods for power results and diagnostics
\item \code{\link{plot_power_fdr}} - Plot power and false discovery rate
\item \code{\link{plot_n_detected}} - Plot number of loci detected
}
}

\section{Workflow}{


\strong{1. Basic power analysis:}

\if{html}{\out{<div class="sourceCode">}}\preformatted{# Determine sample size needed for 80\% power
power_results <- simulate_gea_power(
  n_individuals = seq(50, 200, by = 25),
  n_loci = 5000,
  n_causal = 10,
  effect_size = 0.3,
  response_variable = "composition"
)
plot(power_results)
calculate_required_n(power_results, target_power = 0.8)
}\if{html}{\out{</div>}}

\strong{2. Complex scenario with population structure:}

\if{html}{\out{<div class="sourceCode">}}\preformatted{power_complex <- simulate_gea_power(
  n_individuals = seq(30, 150, by = 20),
  pop_structure = "isolation_by_distance",
  n_populations = 5,
  gradient_type = "linear",
  gxe_interaction = TRUE,
  n_replicates = 200
)
}\if{html}{\out{</div>}}

\strong{3. Diagnose real data:}

\if{html}{\out{<div class="sourceCode">}}\preformatted{# Create holobiont data structure
my_data <- create_holobiont_data(n_individuals = 100)
my_data <- set_host_genotypes(my_data, snp_matrix)
my_data <- set_environment(my_data, "temperature", temp_values)

# Run diagnostics
diag <- diagnose_holobiont_data(my_data)
plot(diag)

# Check GEA assumptions
assumptions <- assess_gea_assumptions(my_data, env_variable = "temperature")
}\if{html}{\out{</div>}}
}

\section{Key Features}{

\itemize{
\item \strong{Realistic simulations}: Coalescent-based population genetics via coala
\item \strong{Flexible design}: 50+ customizable parameters for any GEA scenario
\item \strong{Holobiont focus}: Explicitly models host-microbiome-environment interactions
\item \strong{Population structure}: Supports panmictic, IBD, discrete populations, admixture
\item \strong{Multiple response types}: Abundance, diversity, composition, phenotypes
\item \strong{GxE interactions}: Model genotype-by-environment interactions
\item \strong{Parallel processing}: Multi-core support for fast simulations
\item \strong{Comprehensive diagnostics}: Unique quality checks not available elsewhere
\item \strong{Publication-ready plots}: Built-in ggplot2 visualizations
}
}

\section{Unique Diagnostic Features}{

\itemize{
\item G-E independence testing via genetic PC-environment correlations
\item Signal-to-noise ratio estimation for power assessment
\item Linkage disequilibrium decay rate estimation
\item Environmental gradient strength and spatial autocorrelation
\item Multi-variable collinearity with VIF calculation
\item Holobiont community diagnostics (evenness, prevalence, composition)
\item Population structure confounding detection
\item Integrated assessment combining genetic, environmental, and response data
}
}

\section{Package dependencies}{


\strong{Required packages:}
\itemize{
\item coala - Coalescent simulation for realistic population genetics
\item vegan - RDA (Redundancy Analysis) for GEA
\item ggplot2 - Publication-quality visualizations
\item MASS - Multivariate normal distributions
\item parallel - Multi-core processing
}

\strong{Suggested packages (enhanced functionality):}
\itemize{
\item LEA - LFMM (Latent Factor Mixed Models) analysis
\item irlba - Fast PCA via randomized SVD for large genetic datasets
}
}

\section{Use Cases}{

\itemize{
\item \strong{Experimental planning}: Determine required sample size before fieldwork
\item \strong{Grant proposals}: Justify sampling design with quantitative power analysis
\item \strong{Method comparison}: Compare statistical power across GEA methods (RDA, LFMM, etc.)
\item \strong{Data quality assessment}: Evaluate real datasets before expensive analyses
\item \strong{Sensitivity analysis}: Test how effect size, gradient strength affect power
\item \strong{Holobiont studies}: Optimize designs for host-microbiome association studies
\item \strong{Education}: Understand factors affecting GEA power and assumptions
}
}

\section{Application Examples}{


\strong{Ecological genomics:}
\itemize{
\item Oak-ectomycorrhizal fungi associations along drought gradients
\item Plant-pathogen interactions across temperature gradients
\item Host-microbiome responses to environmental stress
}

\strong{Landscape genomics:}
\itemize{
\item Local adaptation to climate variables
\item Elevation or latitudinal clines
\item Isolation-by-environment patterns
}

\strong{Microbiome studies:}
\itemize{
\item Host genetic control of microbiome composition
\item Environmental filtering of microbial communities
\item Tripartite interactions (host × environment → microbiome)
}
}

\section{Citation}{

To cite phytometr in publications, use:

Felix Zimmermann (2025). phytometr: Power Analysis for Genotype-Environment
Association Studies in Holobiont Systems. R package version 0.1.0.9000.
https://github.com/nnamremmizxilef/phytometr
}

\section{Getting Help}{

\itemize{
\item Package documentation: \code{help(package = "phytometr")}
\item Function help: \code{?simulate_gea_power}
\item Vignettes: \code{browseVignettes("phytometr")}
\item GitHub issues: \url{https://github.com/nnamremmizxilef/phytometr/issues}
}
}

\references{
Forester BR, Lasky JR, Wagner HH, Urban DL (2018).
Comparing methods for detecting multilocus adaptation with multivariate
genotype-environment associations. Molecular Ecology, 27: 2215-2233.

Rellstab C, Gugerli F, Eckert AJ, Hancock AM, Holderegger R (2015).
A practical guide to environmental association analysis in landscape genomics.
Molecular Ecology, 24: 4348-4370.

Capblancq T, Forester BR (2021). Redundancy analysis: A Swiss Army Knife
for landscape genomics. Methods in Ecology and Evolution, 12: 2298-2309.
}
\seealso{
Useful links:
\itemize{
  \item \url{https://github.com/nnamremmizxilef/phytometr}
  \item Report bugs at \url{https://github.com/nnamremmizxilef/phytometr/issues}
}

}
\author{
\strong{Maintainer}: Felix Zimmermann \email{felix.zimmermann@wsl.ch} (\href{https://orcid.org/0009-0002-0762-2454}{ORCID})

}
\keyword{internal}
