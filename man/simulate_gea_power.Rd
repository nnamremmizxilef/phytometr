% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_gea_power.R
\name{simulate_gea_power}
\alias{simulate_gea_power}
\title{Simulate GEA power analysis}
\usage{
simulate_gea_power(
  n_individuals = seq(20, 200, by = 20),
  n_sites = NULL,
  individuals_per_site = NULL,
  n_loci = 5000,
  n_causal = 10,
  mutation_rate = 10,
  recombination_rate = 1,
  maf_threshold = 0.05,
  pop_structure = c("panmictic", "isolation_by_distance", "discrete", "admixture"),
  n_populations = 3,
  migration_rate = 0.01,
  migration_symmetric = TRUE,
  fst = NULL,
  bottleneck = NULL,
  expansion = NULL,
  env_type = c("continuous", "categorical", "multivariate"),
  env_range = c(15, 25),
  env_categories = NULL,
  env_n_variables = 1,
  env_correlation = 0,
  gradient_type = c("linear", "nonlinear", "patchy", "random"),
  gradient_noise = 0.1,
  effect_size = 0.3,
  effect_size_distribution = c("equal", "exponential", "normal"),
  selection_coefficient = NULL,
  dominance = 0.5,
  response_variable = c("abundance", "diversity", "composition", "phenotype"),
  holobiont_heritability = 0.3,
  env_effect_on_holobiont = 0.3,
  gxe_interaction = FALSE,
  gxe_strength = 0.2,
  n_taxa = 100,
  microbiome_structure = c("compositional", "presence_absence", "abundance"),
  baseline_diversity = 50,
  dispersal_limitation = 0.1,
  measurement_error = 0.1,
  biological_noise = 0.2,
  missing_data_rate = 0,
  n_replicates = 100,
  gea_method = c("rda", "lfmm", "baypass", "gemma", "all"),
  correction_method = c("bonferroni", "fdr", "qvalue"),
  alpha = 0.05,
  n_latent_factors = NULL,
  min_effect_to_detect = NULL,
  target_power = 0.8,
  calculate_fdr = TRUE,
  parallel = TRUE,
  n_cores = parallel::detectCores() - 1,
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{n_individuals}{Numeric vector. Sample sizes to test (default: seq(20, 200, by = 20))}

\item{n_sites}{Integer. Number of sampling sites (optional)}

\item{individuals_per_site}{Integer. Individuals per site if n_sites specified}

\item{n_loci}{Integer. Number of genetic loci to simulate (default: 5000)}

\item{n_causal}{Integer. Number of causal loci (default: 10)}

\item{mutation_rate}{Numeric. Mutation rate for coalescent simulation (default: 10)}

\item{recombination_rate}{Numeric. Recombination rate (default: 1)}

\item{maf_threshold}{Numeric. Minor allele frequency filter threshold (default: 0.05)}

\item{pop_structure}{Character. Population structure type: "panmictic", "isolation_by_distance",
"discrete", or "admixture" (default: "panmictic")}

\item{n_populations}{Integer. Number of populations for structured models (default: 3)}

\item{migration_rate}{Numeric. Migration rate between populations (default: 0.01)}

\item{migration_symmetric}{Logical. Symmetric migration? (default: TRUE)}

\item{fst}{Numeric. Target Fst between populations (alternative to migration_rate)}

\item{bottleneck}{List. Bottleneck parameters: list(time = 0.5, reduction = 0.1)}

\item{expansion}{List. Expansion parameters: list(time = 0.3, growth_rate = 2)}

\item{env_type}{Character. Environment type: "continuous", "categorical", "multivariate" (default: "continuous")}

\item{env_range}{Numeric vector. Range for continuous environment (default: c(15, 25))}

\item{env_categories}{Character vector. Categories for categorical environment}

\item{env_n_variables}{Integer. Number of environmental variables if multivariate (default: 1)}

\item{env_correlation}{Numeric. Correlation between environmental variables (default: 0)}

\item{gradient_type}{Character. Gradient shape: "linear", "nonlinear", "patchy", "random" (default: "linear")}

\item{gradient_noise}{Numeric. Within-site environmental noise (default: 0.1)}

\item{effect_size}{Numeric. Strength of genotype-environment association (default: 0.3)}

\item{effect_size_distribution}{Character. Distribution of effect sizes: "equal", "exponential", "normal" (default: "equal")}

\item{selection_coefficient}{Numeric. Selection coefficient (alternative to effect_size)}

\item{dominance}{Numeric. Dominance coefficient: 0 (recessive), 0.5 (additive), 1 (dominant) (default: 0.5)}

\item{response_variable}{Character. Response type: "abundance", "diversity", "composition", "phenotype" (default: "abundance")}

\item{holobiont_heritability}{Numeric. Host genetic control of microbiome (default: 0.3)}

\item{env_effect_on_holobiont}{Numeric. Direct environmental effect on holobiont (default: 0.3)}

\item{gxe_interaction}{Logical. Include GxE interaction? (default: FALSE)}

\item{gxe_strength}{Numeric. Strength of GxE interaction if included (default: 0.2)}

\item{n_taxa}{Integer. Number of microbial taxa (default: 100)}

\item{microbiome_structure}{Character. Microbiome data type: "compositional", "presence_absence", "abundance" (default: "compositional")}

\item{baseline_diversity}{Numeric. Mean alpha diversity (default: 50)}

\item{dispersal_limitation}{Numeric. Spatial autocorrelation in microbiome (default: 0.1)}

\item{measurement_error}{Numeric. Technical measurement noise (default: 0.1)}

\item{biological_noise}{Numeric. Unexplained biological variation (default: 0.2)}

\item{missing_data_rate}{Numeric. Proportion of missing genotypes (default: 0)}

\item{n_replicates}{Integer. Number of simulation replicates per sample size (default: 100)}

\item{gea_method}{Character. GEA method(s): "rda", "lfmm", "baypass", "gemma", "all" (default: "rda")}

\item{correction_method}{Character. Multiple testing correction: "bonferroni", "fdr", "qvalue" (default: "fdr")}

\item{alpha}{Numeric. Significance threshold (default: 0.05)}

\item{n_latent_factors}{Integer. Number of latent factors for LFMM (default: NULL, auto-detect)}

\item{min_effect_to_detect}{Numeric. Minimum effect size of interest}

\item{target_power}{Numeric. Target statistical power (default: 0.8)}

\item{calculate_fdr}{Logical. Calculate false discovery rate? (default: TRUE)}

\item{parallel}{Logical. Use parallel processing? (default: TRUE)}

\item{n_cores}{Integer. Number of cores for parallel processing (default: detectCores() - 1)}

\item{seed}{Integer. Random seed for reproducibility}

\item{verbose}{Logical. Print progress messages? (default: TRUE)}
}
\value{
Object of class 'gea_power_analysis' containing:
\itemize{
\item power: Mean statistical power for each sample size
\item fdr: Mean false discovery rate
\item n_detected: Mean number of loci detected
\item parameters: List of simulation parameters used
}
}
\description{
Performs power analysis for genotype-environment association (GEA) studies
by simulating genetic data, environmental gradients, and holobiont responses.
}
\examples{
\dontrun{
# Basic power analysis
power_results <- simulate_gea_power(
  n_individuals = seq(50, 200, by = 25),
  n_causal = 10,
  effect_size = 0.3
)
plot(power_results)

# Complex scenario with population structure
power_complex <- simulate_gea_power(
  n_individuals = seq(30, 150, by = 20),
  pop_structure = "isolation_by_distance",
  n_populations = 5,
  migration_rate = 0.02,
  gradient_type = "linear",
  response_variable = "composition",
  gxe_interaction = TRUE,
  n_replicates = 200
)
}

}
